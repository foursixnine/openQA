<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>set_distribution</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="paragraph">
<p>include::header.asciidoc
=== init</p>
</div>
<div class="paragraph">
<p>Used for internal initialization, do not call from tests.</p>
</div>
<div class="sect2">
<h3 id="_set_distribution">set_distribution</h3>
<div class="literalblock">
<div class="content">
<pre>set_distribution($distri);</pre>
</div>
</div>
<div class="paragraph">
<p>Set distribution object.</p>
</div>
<div class="paragraph">
<p>You can use distribution object to implement distribution specific helpers.</p>
</div>
</div>
<div class="sect1">
<h2 id="_video_output_handling">video output handling</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_save_screenshot">save_screenshot</h3>
<div class="literalblock">
<div class="content">
<pre>save_screenshot;</pre>
</div>
</div>
<div class="paragraph">
<p>Saves screenshot of current SUT screen.</p>
</div>
</div>
<div class="sect2">
<h3 id="_record_soft_failure">record_soft_failure</h3>
<div class="literalblock">
<div class="content">
<pre>record_soft_failure([$reason]);</pre>
</div>
</div>
<div class="paragraph">
<p>Record a soft failure on the current test modules result. The result will
still be counted as a success. Use this to mark where workarounds are applied.
Takes an optional C&lt;$reason&gt; string which is recorded in the log file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_assert_screen">assert_screen</h3>
<div class="literalblock">
<div class="content">
<pre>assert_screen($mustmatch [,$timeout]);</pre>
</div>
</div>
<div class="paragraph">
<p>Wait for needle with tag C&lt;$mustmatch&gt; to appear on SUT screen.
C&lt;$mustmatch&gt; can be string or C&lt;ARRAYREF&gt; of string (C&lt;['tag1', 'tag2']&gt;).</p>
</div>
<div class="paragraph">
<p>Returns matched needle or throws C&lt;NeedleFailed&gt; exception if $timeout timeout is hit. Default timeout is 30s.</p>
</div>
</div>
<div class="sect2">
<h3 id="_check_screen">check_screen</h3>
<div class="literalblock">
<div class="content">
<pre>check_screen($mustmatch [,$timeout]);</pre>
</div>
</div>
<div class="paragraph">
<p>Similar to C&lt;assert_screen&gt; but does not throw exceptions. Use this for optional matches.
Check C&lt;assert_screen&gt; for parameters.</p>
</div>
<div class="paragraph">
<p>Returns matched needle or C&lt;undef&gt; if timeout is hit. Default timeout is 30s.</p>
</div>
</div>
<div class="sect2">
<h3 id="_match_has_tag">match_has_tag</h3>
<div class="literalblock">
<div class="content">
<pre>match_has_tag($tag);</pre>
</div>
</div>
<div class="paragraph">
<p>Returns true if last matched needle has C&lt;$tag&gt; else return C&lt;undef&gt;.</p>
</div>
</div>
<div class="sect2">
<h3 id="_assert_and_click">assert_and_click</h3>
<div class="literalblock">
<div class="content">
<pre>assert_and_click($mustmatch, [$button], [$timeout], [$click_time], [$dclick]);</pre>
</div>
</div>
<div class="paragraph">
<p>Wait for needle with C&lt;$mustmatch&gt; tag to appear on SUT screen. Then click C&lt;$button&gt; in the middle
of last matched region. If C&lt;$dclick&gt; is set, do double click instead.
C&lt;$mustmatch&gt; can be string or C&lt;ARRAYREF&gt; of strings (C&lt;['tag1', 'tag2']&gt;).
C&lt;$button&gt; is by default C&lt;'left'&gt;. C&lt;'left'&gt; and C&lt;'right'&gt; is supported.</p>
</div>
<div class="paragraph">
<p>Throws C&lt;NeedleFailed&gt; exception if C&lt;$timeout&gt; timeout is hit. Default timeout is 30s.</p>
</div>
</div>
<div class="sect2">
<h3 id="_assert_and_dclick">assert_and_dclick</h3>
<div class="literalblock">
<div class="content">
<pre>assert_and_dclick($mustmatch, $button, [$timeout], [$click_time]);</pre>
</div>
</div>
<div class="paragraph">
<p>Alias for C&lt;assert_and_click&gt; with C&lt;$dclick&gt; set.</p>
</div>
</div>
<div class="sect2">
<h3 id="_wait_screen_change">wait_screen_change</h3>
<div class="literalblock">
<div class="content">
<pre>wait_screen_change { CODEREF [,$timeout] };</pre>
</div>
</div>
<div class="paragraph">
<p>Wrapper around code that is supposed to change the screen.
This is the opposite to C&lt;wait_still_screen&gt;. Make sure to put the commands to change the screen
within the block to avoid races between the action and the screen change.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>wait_screen_change {
   send_key 'esc';
};</pre>
</div>
</div>
<div class="paragraph">
<p>Returns true if screen changed or C&lt;undef&gt; on timeout. Default timeout is 10s.</p>
</div>
</div>
<div class="sect2">
<h3 id="_wait_still_screen">wait_still_screen</h3>
<div class="literalblock">
<div class="content">
<pre>wait_still_screen([$stilltime_sec [, $timeout_sec [, $similarity_level]]]);</pre>
</div>
</div>
<div class="paragraph">
<p>Wait until the screen stops changing.</p>
</div>
<div class="paragraph">
<p>Returns true if screen is not changed for given $stilltime (in seconds) or undef on timeout.
Default timeout is 30s, default stilltime is 7s.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_variable_access">test variable access</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_get_var">get_var</h3>
<div class="literalblock">
<div class="content">
<pre>get_var($variable [, $default ])</pre>
</div>
</div>
<div class="paragraph">
<p>Returns content of test variable C&lt;$variable&gt; or the C&lt;$default&gt; given as second argument or C&lt;undef&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_get_required_var">get_required_var</h3>
<div class="literalblock">
<div class="content">
<pre>get_required_var($variable)</pre>
</div>
</div>
<div class="paragraph">
<p>Similar to C&lt;get_var&gt; but without default value and throws exception if variable can not be retrieved.</p>
</div>
</div>
<div class="sect2">
<h3 id="_set_var">set_var</h3>
<div class="literalblock">
<div class="content">
<pre>set_var($variable, $value);</pre>
</div>
</div>
<div class="paragraph">
<p>Set test variable C&lt;$variable&gt; to value C&lt;$value&gt;.</p>
</div>
</div>
<div class="sect2">
<h3 id="_check_var">check_var</h3>
<div class="literalblock">
<div class="content">
<pre>check_var($variable, $value);</pre>
</div>
</div>
<div class="paragraph">
<p>Returns true if test variable C&lt;$variable&gt; is equal to C&lt;$value&gt; or returns C&lt;undef&gt;.</p>
</div>
</div>
<div class="sect2">
<h3 id="_get_var_array">get_var_array</h3>
<div class="literalblock">
<div class="content">
<pre>get_var_array($variable [, $default ]);</pre>
</div>
</div>
<div class="paragraph">
<p>Return the given variable as array reference (split variable value by , | or ; )</p>
</div>
</div>
<div class="sect2">
<h3 id="_check_var_array">check_var_array</h3>
<div class="literalblock">
<div class="content">
<pre>check_var_array($variable, $value);</pre>
</div>
</div>
<div class="paragraph">
<p>Boolean function to check if a value list contains a value</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_serial_terminal">is_serial_terminal</h3>
<div class="literalblock">
<div class="content">
<pre>is_serial_terminal;</pre>
</div>
</div>
<div class="paragraph">
<p>Determines if communication with the guest is being performed purely over a
serial port. When true, the guest should have a tty attached to a serial port
and os-autoinst sends commands to it as text. This differs from when a text
console is selected in the guest, but VNC is being used to simulate keypresses.</p>
</div>
<div class="paragraph">
<p>When a serial terminal is selected you will not be able to use functions which
rely on needles. This sub is not exported by default as most tests I&lt;will not
benefit&gt; from changing their behaviour depending on if communication happens
over serial or VNC.</p>
</div>
<div class="paragraph">
<p>For more info see consoles/virtio_console.pm and consoles/virtio_screen.pm.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_script_execution_helpers">script execution helpers</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_wait_serial">wait_serial</h3>
<div class="literalblock">
<div class="content">
<pre>wait_serial($regex or ARRAYREF of $regexes [[, $timeout], $expect_not_found]);</pre>
</div>
</div>
<div class="paragraph">
<p>Wait for C&lt;$regex&gt; or anyone of C&lt;$regexes&gt; to appear on serial output.</p>
</div>
<div class="paragraph">
<p>Returns the string matched or C&lt;undef&gt; if C&lt;$expect_not_found&gt; is false
(default).</p>
</div>
<div class="paragraph">
<p>Returns C&lt;undef&gt; or (after timeout) the string that I&lt;did <em>not</em> match&gt; if
C&lt;$expect_not_found&gt; is true.</p>
</div>
</div>
<div class="sect2">
<h3 id="_x11_start_program">x11_start_program</h3>
<div class="literalblock">
<div class="content">
<pre>x11_start_program($program[, $timeout, $options]);</pre>
</div>
</div>
<div class="paragraph">
<p>Start C&lt;$program&gt; in graphical desktop environment.</p>
</div>
<div class="paragraph">
<p>I&lt;The implementation is distribution specific and not always available.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_script_run">script_run</h3>
<div class="literalblock">
<div class="content">
<pre>script_run($program [, $wait]);</pre>
</div>
</div>
<div class="paragraph">
<p>Run C&lt;$program&gt; (by assuming the console prompt and typing it).</p>
</div>
<div class="paragraph">
<p>The C&lt;$wait&gt; parameter will (unless 0) wait for the script to finish
by following the script with an echo to serial line and waiting
for it. Default timeout is 30s.</p>
</div>
<div class="paragraph">
<p>I&lt;Make sure the command does not write to the serial output.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_assert_script_run">assert_script_run</h3>
<div class="literalblock">
<div class="content">
<pre>assert_script_run($cmd [, timeout =&gt; $timeout] [, fail_message =&gt; $fail_message]);</pre>
</div>
</div>
<div class="paragraph">
<p>Deprecated mode</p>
</div>
<div class="literalblock">
<div class="content">
<pre>assert_script_run($cmd [, $timeout [, $fail_message]]);</pre>
</div>
</div>
<div class="paragraph">
<p>Run C&lt;$cmd&gt; via C&lt;script_run&gt; and C&lt;die&gt; if its exit status is not zero.
The exit status is checked by magic string on the serial port.
See C&lt;script_run&gt; for default timeout.
C&lt;$fail_message&gt; is returned in the die message if specified.</p>
</div>
<div class="paragraph">
<p>I&lt;Make sure the command does not write to the serial output.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_script_sudo">script_sudo</h3>
<div class="literalblock">
<div class="content">
<pre>script_sudo($program [, $wait]);</pre>
</div>
</div>
<div class="paragraph">
<p>Run C&lt;$program&gt; using sudo. Handle the sudo timeout and send password when appropriate.
C&lt;$wait_seconds&gt; defaults to 2 seconds.</p>
</div>
<div class="paragraph">
<p>I&lt;The implementation is distribution specific and not always available.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_assert_script_sudo">assert_script_sudo</h3>
<div class="literalblock">
<div class="content">
<pre>assert_script_sudo($command [, $wait]);</pre>
</div>
</div>
<div class="paragraph">
<p>Run C&lt;$command&gt; via C&lt;script_sudo&gt; and then check by C&lt;wait_serial&gt; if its exit
status is not zero.
See C&lt;wait_serial&gt; for default timeout.</p>
</div>
<div class="paragraph">
<p>I&lt;Make sure the command does not write to the serial output.&gt;</p>
</div>
<div class="paragraph">
<p>I&lt;The implementation is distribution specific and not always available.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_script_output">script_output</h3>
<div class="literalblock">
<div class="content">
<pre>script_output($script [, $wait])</pre>
</div>
</div>
<div class="paragraph">
<p>fetches the script through HTTP into the SUT and execs it with C&lt;bash -xe&gt; and directs
C&lt;stdout&gt; (I&lt;not&gt; C&lt;stderr&gt;!) to the serial console and returns the output I&lt;if&gt; the script
exists with 0. Otherwise the test is set to failed.</p>
</div>
<div class="paragraph">
<p>The default timeout for the script is 30 seconds. If you need more, pass a second parameter</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_script_output">validate_script_output</h3>
<div class="literalblock">
<div class="content">
<pre>validate_script_output($script, $code, [$wait])</pre>
</div>
</div>
<div class="paragraph">
<p>Wrapper around script_output, that runs a callback on the output. Use it as</p>
</div>
<div class="literalblock">
<div class="content">
<pre>validate_script_output "cat /etc/hosts", sub { m/127.*localhost/ }</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_become_root">become_root</h3>
<div class="literalblock">
<div class="content">
<pre>become_root;</pre>
</div>
</div>
<div class="paragraph">
<p>Open a root shell.</p>
</div>
<div class="paragraph">
<p>I&lt;The implementation is distribution specific and not always available.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_ensure_installed">ensure_installed</h3>
<div class="literalblock">
<div class="content">
<pre>ensure_installed $package;</pre>
</div>
</div>
<div class="paragraph">
<p>Helper to install a package to SUT.</p>
</div>
<div class="paragraph">
<p>I&lt;The implementation is distribution specific and not always available.&gt;</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_miscellaneous">miscellaneous</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_power">power</h3>
<div class="literalblock">
<div class="content">
<pre>power($action);</pre>
</div>
</div>
<div class="paragraph">
<p>Trigger backend specific power action, can be C&lt;'on'&gt;, C&lt;'off'&gt;, C&lt;'acpi'&gt; or C&lt;'reset'&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_assert_shutdown">assert_shutdown</h3>
<div class="literalblock">
<div class="content">
<pre>assert_shutdown([$timeout]);</pre>
</div>
</div>
<div class="paragraph">
<p>Periodically check backend for status until C&lt;'shutdown'&gt;. Does I&lt;not&gt; initiate shutdown.
Default timeout is 60s</p>
</div>
<div class="paragraph">
<p>Returns C&lt;undef&gt; on success, throws exception on timeout.</p>
</div>
</div>
<div class="sect2">
<h3 id="_eject_cd">eject_cd</h3>
<div class="literalblock">
<div class="content">
<pre>eject_cd;</pre>
</div>
</div>
<div class="paragraph">
<p>if backend supports it, eject the CD</p>
</div>
</div>
<div class="sect2">
<h3 id="_save_memory_dump">save_memory_dump</h3>
<div class="literalblock">
<div class="content">
<pre>save_memory_dump([{ filename =&gt; undef, migration_speed =&gt; "4096m" }]);</pre>
</div>
</div>
<div class="paragraph">
<p>Saves the SUT memory state using C&lt;$filename&gt; as base for the memory dump
filename,  the default will be the current test&#8217;s name.</p>
</div>
<div class="paragraph">
<p>The memory dump can be created at any point, but it&#8217;s recommended to use it
within a post fail hook. Different filenames should be provided if the dump is
being used within the test itself.</p>
</div>
<div class="paragraph">
<p>I&lt;Currently only qemu backend is supported.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_save_storage_drives">save_storage_drives</h3>
<div class="literalblock">
<div class="content">
<pre>save_storage_drives([$filename]);</pre>
</div>
</div>
<div class="paragraph">
<p>Saves all of the SUT drives using C&lt;$filename&gt; as part of the final filename,
the default will be the current test&#8217;s name. The disk number will be always present.</p>
</div>
<div class="paragraph">
<p>This method must be called within a post_fail_hook.</p>
</div>
<div class="paragraph">
<p>I&lt;Currently only qemu backend is supported.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_freeze_vm">freeze_vm</h3>
<div class="literalblock">
<div class="content">
<pre>freeze_vm;</pre>
</div>
</div>
<div class="paragraph">
<p>If the backend supports it, freeze the vm. This will allow the vm to be
paused/frozen within the test, but only from the post_fail_hook. So that memory
and disk dumps can be extracted without any risk of data changing.</p>
</div>
<div class="paragraph">
<p>Call this method to ensure memory and disk dump refer to the same machine state.</p>
</div>
<div class="paragraph">
<p>I&lt;Currently only qemu backend is supported.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_parse_junit_log">parse_junit_log</h3>
<div class="literalblock">
<div class="content">
<pre>parse_junit_log("report.xml");</pre>
</div>
</div>
<div class="paragraph">
<p>Upload log file from SUT (calls upload_logs internally). The uploaded
file is then parsed as jUnit format and extra test results are created from it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_wait_idle">wait_idle</h3>
<div class="literalblock">
<div class="content">
<pre>wait_idle([$timeout_sec]);</pre>
</div>
</div>
<div class="paragraph">
<p>Wait until the system becomes idle (as configured by IDLETHRESHOLD) or timeout.
This function only works on qemu backend and will sleep on other backends. As
such it&#8217;s wasting a lot of time and should be avoided as such. Take it
as last resort if there is nothing else you can assert on.
Default timeout is 19s.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_log_and_data_upload_and_download_helpers">log and data upload and download helpers</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_autoinst_url">autoinst_url</h3>
<div class="literalblock">
<div class="content">
<pre>autoinst_url([$path, $query]);</pre>
</div>
</div>
<div class="paragraph">
<p>returns the base URL to contact the local C&lt;os-autoinst&gt; service</p>
</div>
<div class="paragraph">
<p>Optional C&lt;$path&gt; argument is appended after base url.</p>
</div>
<div class="paragraph">
<p>Optional HASHREF C&lt;$query&gt; is converted to URL query and appended
after path.</p>
</div>
<div class="paragraph">
<p>Returns constructor URL. Can be used inline:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>script_run("curl " . autoinst_url . "/data");</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_url">data_url</h3>
<div class="literalblock">
<div class="content">
<pre>data_url($name);</pre>
</div>
</div>
<div class="paragraph">
<p>returns the URL to download data or asset file
Special values REPO_\d and ASSET_\d points to the asset configured
in the corresponding variable</p>
</div>
</div>
<div class="sect2">
<h3 id="_upload_logs">upload_logs</h3>
<div class="literalblock">
<div class="content">
<pre>upload_logs($file [, failok =&gt; 0 ]);</pre>
</div>
</div>
<div class="paragraph">
<p>Upload C&lt;$file&gt; to OpenQA WebUI as a log file and
return the uploaded file name. If failok is not set, a failed upload
will cause the test to die. Failed uploads happen if the file does not
exist or is over 20 GiB in size, so failok is useful when you just want
to upload the file if it exists but not mind if it doesn&#8217;t.</p>
</div>
</div>
<div class="sect2">
<h3 id="_upload_asset">upload_asset</h3>
<div class="literalblock">
<div class="content">
<pre>upload_asset $file [,$public[,$nocheck]];</pre>
</div>
</div>
<div class="paragraph">
<p>Uploads C&lt;$file&gt; as asset to OpenQA WebUI</p>
</div>
<div class="paragraph">
<p>You can upload private assets only accessible by related jobs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>upload_asset '/tmp/suse.ps';</pre>
</div>
</div>
<div class="paragraph">
<p>Or you can upload public assets that will have a fixed filename
replacing previous assets - useful for external users:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>upload_asset '/tmp/suse.ps', 1;</pre>
</div>
</div>
<div class="paragraph">
<p>If you just want to upload a file and verify that it was uploaded
correctly on your own (e.g. in svirt console we don&#8217;t have a serial
line and can&#8217;t rely on assert_script_run check), add an optional
'nocheck' parameter:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>upload_asset '/tmp/suse.ps', 1, 1;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_keyboard_support">keyboard support</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_send_key">send_key</h3>
<div class="literalblock">
<div class="content">
<pre>send_key($key [, $do_wait]);</pre>
</div>
</div>
<div class="paragraph">
<p>Send one C&lt;$key&gt; to SUT keyboard input.</p>
</div>
<div class="paragraph">
<p>Special characters naming:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>'esc', 'down', 'right', 'up', 'left', 'equal', 'spc',  'minus', 'shift', 'ctrl'
'caps', 'meta', 'alt', 'ret', 'tab', 'backspace', 'end', 'delete', 'home', 'insert'
'pgup', 'pgdn', 'sysrq', 'super'</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hold_key">hold_key</h3>
<div class="literalblock">
<div class="content">
<pre>hold_key($key);</pre>
</div>
</div>
<div class="paragraph">
<p>Hold one C&lt;$key&gt; until release it</p>
</div>
</div>
<div class="sect2">
<h3 id="_release_key">release_key</h3>
<div class="literalblock">
<div class="content">
<pre>release_key($key);</pre>
</div>
</div>
<div class="paragraph">
<p>Release one C&lt;$key&gt; which is kept holding</p>
</div>
</div>
<div class="sect2">
<h3 id="_send_key_until_needlematch">send_key_until_needlematch</h3>
<div class="literalblock">
<div class="content">
<pre>send_key_until_needlematch($tag, $key [, $counter, $timeout]);</pre>
</div>
</div>
<div class="paragraph">
<p>Send specific key until needle with C&lt;$tag&gt; is not matched or C&lt;$counter&gt; is 0.
C&lt;$tag&gt; can be string or C&lt;ARRAYREF&gt; (C&lt;['tag1', 'tag2']&gt;)
Default counter is 20 steps, default timeout is 1s</p>
</div>
<div class="paragraph">
<p>Throws C&lt;NeedleFailed&gt; exception if needle is not matched until C&lt;$counter&gt; is 0.</p>
</div>
</div>
<div class="sect2">
<h3 id="_type_string">type_string</h3>
<div class="literalblock">
<div class="content">
<pre>type_string($string [, max_interval =&gt; &lt;num&gt; ] [, wait_screen_changes =&gt; &lt;num&gt; ] [, secret =&gt; 1 ] );</pre>
</div>
</div>
<div class="paragraph">
<p>send a string of characters, mapping them to appropriate key names as necessary</p>
</div>
<div class="paragraph">
<p>you can pass optional parameters with following keys:</p>
</div>
<div class="paragraph">
<p>C&lt;max_interval (1-250)&gt; determines the typing speed, the lower the
C&lt;max_interval&gt; the slower the typing.</p>
</div>
<div class="paragraph">
<p>C&lt;wait_screen_change&gt; if set, type only this many characters at a time
C&lt;wait_screen_change&gt; and wait for the screen to change between sets.</p>
</div>
<div class="paragraph">
<p>C&lt;secret (bool)&gt; suppresses logging of the actual string typed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_type_password">type_password</h3>
<div class="literalblock">
<div class="content">
<pre>type_password([$password]);</pre>
</div>
</div>
<div class="paragraph">
<p>A convenience wrapper around C&lt;type_string&gt;, which doesn&#8217;t log the string.</p>
</div>
<div class="paragraph">
<p>Uses C&lt;$testapi::password&gt; if no string is given.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mouse_support">mouse support</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_mouse_set">mouse_set</h3>
<div class="literalblock">
<div class="content">
<pre>mouse_set($x, $y);</pre>
</div>
</div>
<div class="paragraph">
<p>Move mouse pointer to given coordinates</p>
</div>
</div>
<div class="sect2">
<h3 id="_mouse_click">mouse_click</h3>
<div class="literalblock">
<div class="content">
<pre>mouse_click([$button, $hold_time]);</pre>
</div>
</div>
<div class="paragraph">
<p>Click mouse C&lt;$button&gt;. Can be C&lt;'left'&gt; or C&lt;'right'&gt;. Set C&lt;$hold_time&gt; to hold button for set time in seconds.
Default hold time is 1s</p>
</div>
</div>
<div class="sect2">
<h3 id="_mouse_dclick">mouse_dclick</h3>
<div class="literalblock">
<div class="content">
<pre>mouse_dclick([$button, $hold_time]);</pre>
</div>
</div>
<div class="paragraph">
<p>Same as mouse_click only for double click.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mouse_tclick">mouse_tclick</h3>
<div class="literalblock">
<div class="content">
<pre>mouse_tclick([$button, $hold_time]);</pre>
</div>
</div>
<div class="paragraph">
<p>Same as mouse_click only for triple click.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mouse_hide">mouse_hide</h3>
<div class="literalblock">
<div class="content">
<pre>mouse_hide([$border_offset]);</pre>
</div>
</div>
<div class="paragraph">
<p>Hide mouse cursor by moving it out of screen area.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multi_console_support">multi console support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All C&lt;testapi&gt; commands that interact with the system under test do that
through a console.  C&lt;send_key&gt;, C&lt;type_string&gt; type into a console.
C&lt;assert_screen&gt; 'looks' at a console, C&lt;assert_and_click&gt; looks at
and clicks on a console.</p>
</div>
<div class="paragraph">
<p>Most backends support several consoles in some way.  These consoles
then have names as defined by the backend.</p>
</div>
<div class="paragraph">
<p>Consoles can be selected for interaction with the system under test.
One of them is 'selected' by default, as defined by the backend.</p>
</div>
<div class="paragraph">
<p>There are no consoles predefined by default, the distribution has
to add them during initial setup and define actions on what should
happen when they are selected first by the tests.</p>
</div>
<div class="paragraph">
<p>E.g. your distribution can give e.g. C&lt;tty2&gt; and C&lt;tty4&gt; a name for the
tests to select</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$self-&gt;add_console('root-console',  'tty-console', {tty =&gt; 2});
$self-&gt;add_console('user-console',  'tty-console', {tty =&gt; 4});</pre>
</div>
</div>
<div class="sect2">
<h3 id="_add_console">add_console</h3>
<div class="literalblock">
<div class="content">
<pre>add_console("console", "console type" [, optional console parameters...])</pre>
</div>
</div>
<div class="paragraph">
<p>You need to do this in your distribution and not in tests. It will not trigger
any action on the system under test, but only store the parameters.</p>
</div>
<div class="paragraph">
<p>The console parameters are console specific.</p>
</div>
<div class="paragraph">
<p>I&lt;The implementation is distribution specific and not always available.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_select_console">select_console</h3>
<div class="literalblock">
<div class="content">
<pre>select_console("root-console")</pre>
</div>
</div>
<div class="paragraph">
<p>Select the named console for further C&lt;testapi&gt; interaction (send_text,
send_key, wait_screen_change, &#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>If this the first time, a test selects this console, the distribution
will get a call into activate_console('root-console', $console_obj) to
make sure to actually log in root. For the backend it&#8217;s just a C&lt;tty&gt;
object (in this example) - so it will ensure the console is active,
but to setup the root shell on this console, the distribution needs
to run test code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_console">console</h3>
<div class="literalblock">
<div class="content">
<pre>console("testapi_console")-&gt;$console_command(@console_command_args)</pre>
</div>
</div>
<div class="paragraph">
<p>Some consoles have special commands beyond C&lt;type_string&gt;, C&lt;assert_screen&gt;</p>
</div>
<div class="paragraph">
<p>Such commands can be accessed using this API.</p>
</div>
<div class="paragraph">
<p>C&lt;console("bootloader")&gt;, C&lt;console("errorlog")&gt;, &#8230;&#8203; returns a proxy
object for the specific console which can then be directly accessed.</p>
</div>
<div class="paragraph">
<p>This is also useful for typing/interacting 'in the background',
without turning the video away from the currently selected console.</p>
</div>
<div class="paragraph">
<p>Note: C&lt;assert_screen()&gt; and friends look at the currently selected
console (select_console), no matter which console you send commands to
here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reset_consoles">reset_consoles</h3>
<div class="literalblock">
<div class="content">
<pre>reset_consoles;</pre>
</div>
</div>
<div class="paragraph">
<p>will make sure the next select_console will activate the console. This is important
if you did something to the system that affects the console (e.g. trigger reboot).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_audio_support">audio support</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_start_audiocapture">start_audiocapture</h3>
<div class="literalblock">
<div class="content">
<pre>start_audiocapture;</pre>
</div>
</div>
<div class="paragraph">
<p>Tells the backend to record a C&lt;.wav&gt; file of the sound card.</p>
</div>
<div class="paragraph">
<p>I&lt;Only supported by qemu backend.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_assert_recorded_sound">assert_recorded_sound</h3>
<div class="literalblock">
<div class="content">
<pre>assert_recorded_sound('we-will-rock-you');</pre>
</div>
</div>
<div class="paragraph">
<p>Tells the backend to record a C&lt;.wav&gt; file of the sound card.</p>
</div>
<div class="paragraph">
<p>I&lt;Only supported by QEMU backend.&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_diag">diag</h3>
<div class="literalblock">
<div class="content">
<pre>diag('important message');</pre>
</div>
</div>
<div class="paragraph">
<p>Write a diagnostic message to the logfile. In color, if possible.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hashed_string">hashed_string</h3>
<div class="literalblock">
<div class="content">
<pre>hashed_string();</pre>
</div>
</div>
<div class="paragraph">
<p>Return a short string representing the given string by passing it through the
MD5 algorithm and taking the first characters.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-12-22 17:29:18 CET
</div>
</div>
</body>
</html>